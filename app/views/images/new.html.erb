<h2>Tシャツを追加する</h2>

<div class="row">
    <div class="col-md-6 offset-md-3">
        <%= form_for @image do |f| %>
            <div class="form-group">
                <%= f.label :Tシャツの写真 %>
                <%= f.drag_and_drop_file_field :image, "ここにTシャツの写真をドラッグ&ドロップしよう" %>
            </div>

            <div class="form-group">
                <%= f.label :Tシャツの詳細 %>
                <%= f.text_area :description, class: 'form-control' %>
            </div>

            <div>
            <a><%= f.submit "Tシャツを追加する", class: 'btn-gradient-radius' %></a>
            </div>
        <% end %>
    </div>
</div>

<script>
    (function() {
        var reader = new FileReader()
        var form = document.querySelector('#new_image')
        var field = document.querySelector('#image_image')
        var preview = document.querySelector('#asdndz-image_image')

        reader.onload = function(e) {
            preview.style.backgroundImage = 'url(${e.srcElement.result})'
        }

        field.addEventListener('dnd-upload:initialize', function(e) {
            reader.readAsDataURL(e.detail.file)
        }, false)

        form.addEventListener('click', function(e) {
            if (event.target.dataset.dndDelete === 'true') {
                preview.style.backgroundImage = ''
            }
        }, true)
    })()
</script>